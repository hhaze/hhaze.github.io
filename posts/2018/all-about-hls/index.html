<!DOCTYPE html><html><head><meta charset="utf-8"><title>HLS (Http Live Streaming) | 블로구</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="OverviewHLS는 Apple에서 만든 HTTP 기반의 스트리밍 프로토콜이다. 현재 기준 (2018.08) 최신 프로토콜 버전은 8이고, 관련 스펙은 2nd Edition으로 계속 업데이트 되고 있다. 구성 요소 이미지 출처: https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;http_live_streaming HLS는 Play"><meta property="og:type" content="article"><meta property="og:title" content="HLS (Http Live Streaming)"><meta property="og:url" content="https://hhaze.github.io/posts/2018/all-about-hls/index.html"><meta property="og:site_name" content="블로구"><meta property="og:description" content="OverviewHLS는 Apple에서 만든 HTTP 기반의 스트리밍 프로토콜이다. 현재 기준 (2018.08) 최신 프로토콜 버전은 8이고, 관련 스펙은 2nd Edition으로 계속 업데이트 되고 있다. 구성 요소 이미지 출처: https:&#x2F;&#x2F;developer.apple.com&#x2F;documentation&#x2F;http_live_streaming HLS는 Play"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://docs-assets.developer.apple.com/published/88e87744a3/de18e941-81de-482f-843d-834a4dd3aa71.png"><meta property="article:published_time" content="2018-08-29T13:35:34.000Z"><meta property="article:modified_time" content="2021-04-04T02:37:53.890Z"><meta property="article:author" content="jhgu"><meta property="article:tag" content="HLS"><meta property="article:tag" content="Streaming"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://docs-assets.developer.apple.com/published/88e87744a3/de18e941-81de-482f-843d-834a4dd3aa71.png"><link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131535785-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-131535785-1")</script><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="블로구" type="application/atom+xml">
</head><body><div class="site-wrapper is_post_page"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="w">블</span> <span class="w">로</span> <span class="b">구</span> </a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-all-about-hls" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">HLS (Http Live Streaming)</h1><div class="article-meta">Posted on <time class="article-time" datetime="2018-08-29T13:35:34.000Z" itemprop="datePublished">8월 29, 2018</time></div></header><div class="article-entry" itemprop="articleBody"><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>HLS는 Apple에서 만든 HTTP 기반의 스트리밍 프로토콜이다. 현재 기준 (2018.08) 최신 프로토콜 버전은 8이고, 관련 스펙은 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-pantos-hls-rfc8216bis-02#page-4">2nd Edition</a>으로 계속 업데이트 되고 있다.</p><h4 id="구성-요소"><a href="#구성-요소" class="headerlink" title="구성 요소"></a>구성 요소</h4><p><img src="https://docs-assets.developer.apple.com/published/88e87744a3/de18e941-81de-482f-843d-834a4dd3aa71.png"></p><p>이미지 출처: <a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/http_live_streaming">https://developer.apple.com/documentation/http_live_streaming</a></p><p>HLS는 <code>Playlist</code>라고 부르는 <code>.m3u8</code> 파일을 통해 서비스 되는데 그 과정은 다음과 같다.</p><ul><li>Input(Content)이 MPEG-TS로 인코딩되고</li><li>인코딩 된 파일을 고정 값(duration)을 가지는 .ts 파일들로 작게 나누고 @서버</li><li>그 파일들을 인덱싱해서 playlist 파일로 서비스하고</li><li>URL로 .m3u8 및 .ts 파일을 요청 및 다운로드 받아 재생하고 @클라이언트</li></ul><p>즉, 서버에서는 컨텐츠를 인코딩해서 자르고 클라이언트에서는 그 조각난 파일들을 받아 재생한다.</p><h2 id="Adaptive-Streaming"><a href="#Adaptive-Streaming" class="headerlink" title="Adaptive Streaming"></a>Adaptive Streaming</h2><p>HLS의 탄생 배경을 이해하기 위해 Adaptive Streaming에 대해 알고 있으면 좋다.</p><p>Adaptive Streaming이란 Multi-bitrate을 지원하는 스트리밍 방식을 말한다. 실시간으로 네트워크 상태에 따라 High&lt;-&gt;Low Bitrate switching을 하며 <code>끊김없는 재생</code>을 목표로 한다. 기존에는 전체 100을 한 번에 다운로드 받았다면, Adaptive에서는 전체 100을 10개의 조각(segment)으로 나누어 그 때 그 때 네트워크 상황에 맞추어 High-Mid-Low Bitrate stream을 선택하는 것이다. 이는 결국 <code>버퍼링을 최소화</code>하고 최적의 환경을 제공하기 위함이다.</p><p>HLS는 바로 이 Adaptive streaming의 한 종류이다. 대표적인 다른 프로토콜은 MPEG-DASH, Microsoft Smooth Streaming 등이 있다.</p><h2 id="Playlist"><a href="#Playlist" class="headerlink" title="Playlist"></a>Playlist</h2><p>HLS는 Manifest로 <code>.m3u8</code> 확장자를 가지는 <code>playlist</code> 파일을 사용한다. (각 프로토콜 별로 Manifest 파일의 확장자가 다르다.) playlist에는 <code>Master Playlist</code> 그리고 <code>Media Playlist</code> 두 종류가 있다. Master Playlist가 Media Playlist를 품고 있는 구조이다. Master Playlist에는 Stream 전체에 대한 정보가 Media Playlist에는 Segment에 대한 정보가 있다고 보면 된다.</p><p>Example을 보면 이해하기 좋을 것 같다. 공식 Draft에 있는 Example을 발췌하여 약간 수정했다.</p><p><strong>Master Playlist</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#EXTM3U</span><br><span class="line">#EXT-X-STREAM-INF:BANDWIDTH&#x3D;1280000,AVERAGE-BANDWIDTH&#x3D;1000000</span><br><span class="line">http:&#x2F;&#x2F;example.com&#x2F;low.m3u8</span><br><span class="line">#EXT-X-STREAM-INF:BANDWIDTH&#x3D;2560000,AVERAGE-BANDWIDTH&#x3D;2000000</span><br><span class="line">http:&#x2F;&#x2F;example.com&#x2F;mid.m3u8</span><br><span class="line">#EXT-X-STREAM-INF:BANDWIDTH&#x3D;7680000,AVERAGE-BANDWIDTH&#x3D;6000000</span><br><span class="line">http:&#x2F;&#x2F;example.com&#x2F;hi.m3u8</span><br></pre></td></tr></table></figure><p><strong>Media Playlist</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#EXTM3U</span><br><span class="line">#EXT-X-TARGETDURATION:10</span><br><span class="line">#EXT-X-VERSION:3</span><br><span class="line">#EXTINF:9.009,</span><br><span class="line">first.ts</span><br><span class="line">#EXTINF:9.009,</span><br><span class="line">second.ts</span><br><span class="line">#EXTINF:3.003,</span><br><span class="line">third.ts</span><br><span class="line">#EXT-X-ENDLIST</span><br></pre></td></tr></table></figure><p>예제에는 없지만 처음에 Master Playlist를 다운로드 받기 위한 URL이 있을 것이고, 그 파일의 내용이 위와 같다고 하자. <code>BANDWIDTH</code> 속성 값으로 나누어져 있는 URL이 Media Playlist를 다운로드 받기 위한 URL이 된다. - low.m3u8 / mid.m3u8 / hi.m3u8</p><p>Multi-bitrate으로 인코딩 된 컨텐츠를 제공할 뿐, 동시에 여러 개의 Bandwidth를 재생하는 것은 아니다. 따라서 재생 시점에는 현재 네트워크 상황에 맞는 하나의 Media Playlist가 선택되고, 해당 Media Playlist에 명시된 .ts 파일들을 순차 재생하게 된다.</p><p>예를 들어, Media Playlist로 <a target="_blank" rel="noopener" href="http://example.com/mid.m3u8">http://example.com/mid.m3u8</a> URL이 선택되었다면 처음 .ts 파일을 받기 위한 URL은 <a target="_blank" rel="noopener" href="http://example.com/mid/first.ts">http://example.com/mid/first.ts</a> 같은 형식이 되는 것이다. High-bitrate으로 Switching 되어 재생을 이어간다면, <a target="_blank" rel="noopener" href="http://example.com/hi/second.ts">http://example.com/hi/second.ts</a> 파일을 다운로드 받게 될 것이다.</p><p>즉, 각 Media Playlist에 있는 .ts 파일들은 동일한 컨텐츠를 담고 있는 것이다. <code>#EXTINF</code> Tag는 Duration 값을 나타내는데 아래 파일들 모두 9초 분량의 동일 컨텐츠인 셈이다. 물론 해상도는 다를 것이다.</p><ul><li>low/first.ts</li><li>mid/first.ts</li><li>hi/first.ts</li></ul><hr><p>다 아는 내용이라 금방일 줄 알았는데 괜찮은 글로 정리하려니 시간이 오래 걸린다. Tag는 굉장히 많아서 그 소개는 다음 포스팅으로 넘어가야 할 것 같다. 🧐</p></div><div class="article-tags"><a class="tag-none-link" href="/tags/HLS/" rel="tag">HLS</a><a class="tag-none-link" href="/tags/Streaming/" rel="tag">Streaming</a></div><section id="comments" class="white-box"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></article><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div>&copy; <a href="https://hhaze.github.io">블로구</a> Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div><div>Powered by <a target="_blank" href="https://hexo.io/" rel="external noopener">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></div><div class="site-sidebar"><div class="sidebar-switch clearfix" style="display:none"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-toc" style="display:none"><div class="no-index">No Index</div></div><div class="site-bio show" style="display:block"><div class="about-me clearfix"><div class="avatar"><img src="/img/avatar.png"></div><div class="info"><div>jhgu</div></div><div class="info"><span class="item desc"></span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="mailto:jhgu.dev@gmail.com" class="mail" target="_blank" rel="external"><span class="icon icon-mail"></span> </a><a href="https://github.com/hhaze" class="github" target="_blank" rel="external"><span class="icon icon-github"></span></a></div></div><div class="shortcuts"><a class="close dark-btn" id="sidebar-close"><span class="icon icon-close"></span></a></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="",AZURE_INDEX_NAME="",AZURE_QUERY_KEY="",BAIDU_API_ID="",SEARCH_SERVICE="hexo",universalSearchConfig={};"google"===SEARCH_SERVICE?universalSearchConfig={searchService:SEARCH_SERVICE,apiKey:GOOGLE_CUSTOM_SEARCH_API_KEY,engineId:GOOGLE_CUSTOM_SEARCH_ENGINE_ID,imagePath:"/img/"}:"algolia"===SEARCH_SERVICE?universalSearchConfig={searchService:SEARCH_SERVICE,apiKey:ALGOLIA_API_KEY,appId:ALGOLIA_APP_ID,indexName:ALGOLIA_INDEX_NAME,imagePath:"/img/"}:"azure"===SEARCH_SERVICE&&(universalSearchConfig={searchService:SEARCH_SERVICE,serviceName:AZURE_SERVICE_NAME,indexName:AZURE_INDEX_NAME,apiKey:AZURE_QUERY_KEY,imagePath:"/img/"})</script><script src="https://code.jquery.com/jquery-2.1.4.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script type="text/javascript">var disqus_shortname="hhaze",disqus_url="https://hhaze.github.io/posts/2018/all-about-hls/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script>document.getElementById("loading-bar").style.width="100%"</script></body></html>